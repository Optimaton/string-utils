#include <string.h>
#include <stdio.h>
#include <stdlib.h>
#include <stdbool.h>
#include <stdint.h>
#include <stdarg.h>
#include <string_utils.h>

void 
assign(String** haystack, const char* value, uint64_t value_size)
{
  /* struct string consists of a character pointer */
  if (!(*haystack)) {
    uint64_t alloc_size = value_size + (2 * sizeof(int));
    *haystack = (String *)malloc(alloc_size);
    (*haystack)->data = (char *)malloc(value_size);
  }
  if (*haystack) {
    memcpy((*haystack)->data, value, value_size);
  } else {
    printf("Internal Error: Could not allocate memory.");  
  }
}

int main()
{
  String* haystack = NULL;
  const char* value = "this is so beautiful";
  
  assign(&haystack, value, strlen(value) + 1);
  printf("Haystack holds %s", haystack->data);

  return 0;
}

